<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Spatial Data Science</title>
  <meta name="description" content="description_xx">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Spatial Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="description_xx" />
  <meta name="github-repo" content="edzer/sdsr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Spatial Data Science" />
  
  <meta name="twitter:description" content="description_xx" />
  

<meta name="author" content="Edzer Pebesma, Roger Bivand">


<meta name="date" content="2019-01-15">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="featureattributes.html">
<link rel="next" href="plotting.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.1.17/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<link href="libs/PopupTable-0.0.1/popup.css" rel="stylesheet" />


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Spatial Data</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#a-first-map"><i class="fa fa-check"></i><b>1.1</b> A first map</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#reading"><i class="fa fa-check"></i><b>1.2</b> Reading and writing</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cs.html"><a href="cs.html"><i class="fa fa-check"></i><b>2</b> Coordinate systems</a><ul>
<li class="chapter" data-level="2.1" data-path="cs.html"><a href="cs.html#cartesian-and-geodetic-coordinates"><i class="fa fa-check"></i><b>2.1</b> Cartesian and geodetic coordinates</a></li>
<li class="chapter" data-level="2.2" data-path="cs.html"><a href="cs.html#ellipsoidal-coordinates"><i class="fa fa-check"></i><b>2.2</b> Ellipsoidal coordinates</a></li>
<li class="chapter" data-level="2.3" data-path="cs.html"><a href="cs.html#distances"><i class="fa fa-check"></i><b>2.3</b> Distances</a></li>
<li class="chapter" data-level="2.4" data-path="cs.html"><a href="cs.html#bounded-spaces"><i class="fa fa-check"></i><b>2.4</b> Bounded spaces</a></li>
<li class="chapter" data-level="2.5" data-path="cs.html"><a href="cs.html#time"><i class="fa fa-check"></i><b>2.5</b> Time</a></li>
<li class="chapter" data-level="2.6" data-path="cs.html"><a href="cs.html#exercises-1"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geometries.html"><a href="geometries.html"><i class="fa fa-check"></i><b>3</b> Geometries</a><ul>
<li class="chapter" data-level="3.1" data-path="geometries.html"><a href="geometries.html#simple-feature-geometry-types"><i class="fa fa-check"></i><b>3.1</b> Simple feature geometry types</a></li>
<li class="chapter" data-level="3.2" data-path="geometries.html"><a href="geometries.html#simple-features-in-sf"><i class="fa fa-check"></i><b>3.2</b> Simple features in <code>sf</code></a></li>
<li class="chapter" data-level="3.3" data-path="geometries.html"><a href="geometries.html#geomraster"><i class="fa fa-check"></i><b>3.3</b> Tesselations: coverages, rasters</a></li>
<li class="chapter" data-level="3.4" data-path="geometries.html"><a href="geometries.html#networks"><i class="fa fa-check"></i><b>3.4</b> Networks</a></li>
<li class="chapter" data-level="3.5" data-path="geometries.html"><a href="geometries.html#geometries-on-the-sphere"><i class="fa fa-check"></i><b>3.5</b> Geometries on the sphere</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>4</b> Raster and vector datacubes</a><ul>
<li class="chapter" data-level="4.1" data-path="raster.html"><a href="raster.html#package-stars"><i class="fa fa-check"></i><b>4.1</b> Package <code>stars</code></a></li>
<li class="chapter" data-level="4.2" data-path="raster.html"><a href="raster.html#raster-data"><i class="fa fa-check"></i><b>4.2</b> Raster data</a></li>
<li class="chapter" data-level="4.3" data-path="raster.html"><a href="raster.html#datacubes"><i class="fa fa-check"></i><b>4.3</b> Vector Datacubes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="geommanip.html"><a href="geommanip.html"><i class="fa fa-check"></i><b>5</b> Manipulating Geometries</a><ul>
<li class="chapter" data-level="5.1" data-path="geommanip.html"><a href="geommanip.html#predicates"><i class="fa fa-check"></i><b>5.1</b> Predicates</a></li>
<li class="chapter" data-level="5.2" data-path="geommanip.html"><a href="geommanip.html#measures"><i class="fa fa-check"></i><b>5.2</b> Measures</a></li>
<li class="chapter" data-level="5.3" data-path="geommanip.html"><a href="geommanip.html#geometry-generating-functions"><i class="fa fa-check"></i><b>5.3</b> Geometry generating functions</a></li>
<li class="chapter" data-level="5.4" data-path="geommanip.html"><a href="geommanip.html#precision"><i class="fa fa-check"></i><b>5.4</b> Precision</a></li>
<li class="chapter" data-level="5.5" data-path="geommanip.html"><a href="geommanip.html#invalid"><i class="fa fa-check"></i><b>5.5</b> Generating invalid geometries</a></li>
<li class="chapter" data-level="5.6" data-path="geommanip.html"><a href="geommanip.html#longlat"><i class="fa fa-check"></i><b>5.6</b> Warnings for longitude/latitude geometries</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="featureattributes.html"><a href="featureattributes.html"><i class="fa fa-check"></i><b>6</b> Feature attributes</a><ul>
<li class="chapter" data-level="6.1" data-path="featureattributes.html"><a href="featureattributes.html#agr"><i class="fa fa-check"></i><b>6.1</b> Attribute-geometry relationships</a></li>
<li class="chapter" data-level="6.2" data-path="featureattributes.html"><a href="featureattributes.html#spatial-join"><i class="fa fa-check"></i><b>6.2</b> Spatial join</a></li>
<li class="chapter" data-level="6.3" data-path="featureattributes.html"><a href="featureattributes.html#aggregate-and-summarise"><i class="fa fa-check"></i><b>6.3</b> Aggregate and summarise</a></li>
<li class="chapter" data-level="6.4" data-path="featureattributes.html"><a href="featureattributes.html#intersections"><i class="fa fa-check"></i><b>6.4</b> Intersections</a></li>
<li class="chapter" data-level="6.5" data-path="featureattributes.html"><a href="featureattributes.html#area-weighted-interpolation"><i class="fa fa-check"></i><b>6.5</b> Area-weighted interpolation</a></li>
<li class="chapter" data-level="6.6" data-path="featureattributes.html"><a href="featureattributes.html#exercises-2"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rs.html"><a href="rs.html"><i class="fa fa-check"></i><b>7</b> Reference Systems</a><ul>
<li class="chapter" data-level="7.1" data-path="rs.html"><a href="rs.html#units"><i class="fa fa-check"></i><b>7.1</b> Units of measurement</a></li>
<li class="chapter" data-level="7.2" data-path="rs.html"><a href="rs.html#temporal-reference-systems"><i class="fa fa-check"></i><b>7.2</b> Temporal Reference Systems</a></li>
<li class="chapter" data-level="7.3" data-path="rs.html"><a href="rs.html#crs"><i class="fa fa-check"></i><b>7.3</b> Coordinate Reference Systems</a></li>
</ul></li>
<li class="part"><span><b>II Maps</b></span></li>
<li class="chapter" data-level="8" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>8</b> Plotting spatial data</a><ul>
<li class="chapter" data-level="8.1" data-path="plotting.html"><a href="plotting.html#transform"><i class="fa fa-check"></i><b>8.1</b> Every plot is a projection</a></li>
<li class="chapter" data-level="8.2" data-path="plotting.html"><a href="plotting.html#plotting-points-lines-polygons-grid-cells"><i class="fa fa-check"></i><b>8.2</b> Plotting points, lines, polygons, grid cells</a></li>
<li class="chapter" data-level="8.3" data-path="plotting.html"><a href="plotting.html#class-intervals"><i class="fa fa-check"></i><b>8.3</b> Class intervals</a></li>
<li class="chapter" data-level="8.4" data-path="plotting.html"><a href="plotting.html#poles-and-datelines"><i class="fa fa-check"></i><b>8.4</b> Poles and datelines</a></li>
<li class="chapter" data-level="8.5" data-path="plotting.html"><a href="plotting.html#graticule"><i class="fa fa-check"></i><b>8.5</b> Graticules and other navigation aids</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="plot.html"><a href="plot.html"><i class="fa fa-check"></i><b>9</b> Base and grid plots</a><ul>
<li class="chapter" data-level="9.1" data-path="plot.html"><a href="plot.html#base-plots"><i class="fa fa-check"></i><b>9.1</b> Base plots</a></li>
<li class="chapter" data-level="9.2" data-path="plot.html"><a href="plot.html#combining-base-plots"><i class="fa fa-check"></i><b>9.2</b> Combining base plots</a></li>
<li class="chapter" data-level="9.3" data-path="plot.html"><a href="plot.html#grid-plots-and-viewports"><i class="fa fa-check"></i><b>9.3</b> Grid plots and viewports</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>10</b> ggplot2</a><ul>
<li class="chapter" data-level="10.1" data-path="ggplot2.html"><a href="ggplot2.html#geom_sf"><i class="fa fa-check"></i><b>10.1</b> <code>geom_sf</code></a></li>
<li class="chapter" data-level="10.2" data-path="ggplot2.html"><a href="ggplot2.html#using-stars-objects-with-ggplot2"><i class="fa fa-check"></i><b>10.2</b> using <code>stars</code> objects with <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="interactive-maps.html"><a href="interactive-maps.html"><i class="fa fa-check"></i><b>11</b> Interactive Maps</a></li>
<li class="part"><span><b>III Spatial Analysis</b></span></li>
<li class="chapter" data-level="12" data-path="summarizing-geometries.html"><a href="summarizing-geometries.html"><i class="fa fa-check"></i><b>12</b> Summarizing Geometries</a></li>
<li class="chapter" data-level="13" data-path="pp.html"><a href="pp.html"><i class="fa fa-check"></i><b>13</b> Point Pattern Analysis</a></li>
<li class="chapter" data-level="14" data-path="manipulating-attributes-summarise-aggregate-union-sample.html"><a href="manipulating-attributes-summarise-aggregate-union-sample.html"><i class="fa fa-check"></i><b>14</b> Manipulating attributes: summarise, aggregate, union, sample</a></li>
<li class="chapter" data-level="15" data-path="up-and-downscaling.html"><a href="up-and-downscaling.html"><i class="fa fa-check"></i><b>15</b> Up- and Downscaling</a></li>
<li class="chapter" data-level="16" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html"><i class="fa fa-check"></i><b>16</b> Spatial Interpolation and geostatistics</a><ul>
<li class="chapter" data-level="16.1" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html#load-meuse-data"><i class="fa fa-check"></i><b>16.1</b> Load meuse data</a></li>
<li class="chapter" data-level="16.2" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html#fit-variogram"><i class="fa fa-check"></i><b>16.2</b> fit variogram</a></li>
<li class="chapter" data-level="16.3" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html#kriging-to-point-locations"><i class="fa fa-check"></i><b>16.3</b> kriging to point locations:</a></li>
<li class="chapter" data-level="16.4" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html#kriging-to-stars-grid"><i class="fa fa-check"></i><b>16.4</b> kriging to stars grid:</a></li>
<li class="chapter" data-level="16.5" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html#spatio-temporal"><i class="fa fa-check"></i><b>16.5</b> Spatio-temporal</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="area-data-and-spatial-correlation.html"><a href="area-data-and-spatial-correlation.html"><i class="fa fa-check"></i><b>17</b> Area Data and Spatial Correlation</a></li>
<li class="chapter" data-level="18" data-path="spatial-regression-and-autocorrelation.html"><a href="spatial-regression-and-autocorrelation.html"><i class="fa fa-check"></i><b>18</b> Spatial Regression and Autocorrelation</a></li>
<li class="chapter" data-level="19" data-path="movement-data.html"><a href="movement-data.html"><i class="fa fa-check"></i><b>19</b> Movement data</a></li>
<li class="chapter" data-level="20" data-path="statistical-modelling-of-spatiotemporal-data.html"><a href="statistical-modelling-of-spatiotemporal-data.html"><i class="fa fa-check"></i><b>20</b> Statistical modelling of spatiotemporal data</a></li>
<li class="chapter" data-level="21" data-path="sp-and-raster.html"><a href="sp-and-raster.html"><i class="fa fa-check"></i><b>21</b> sp and raster</a><ul>
<li class="chapter" data-level="21.1" data-path="sp-and-raster.html"><a href="sp-and-raster.html#links-and-differences-between-sf-and-sp"><i class="fa fa-check"></i><b>21.1</b> links and differences between sf and sp</a></li>
<li class="chapter" data-level="21.2" data-path="sp-and-raster.html"><a href="sp-and-raster.html#migration-packages"><i class="fa fa-check"></i><b>21.2</b> migration packages</a></li>
<li class="chapter" data-level="21.3" data-path="sp-and-raster.html"><a href="sp-and-raster.html#raster-stars-and-sf"><i class="fa fa-check"></i><b>21.3</b> raster, stars and sf</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-data-structures.html"><a href="r-data-structures.html"><i class="fa fa-check"></i>R data structures</a><ul>
<li class="chapter" data-level="21.4" data-path="r-data-structures.html"><a href="r-data-structures.html#homogeneous-vectors"><i class="fa fa-check"></i><b>21.4</b> Homogeneous vectors</a></li>
<li class="chapter" data-level="21.5" data-path="r-data-structures.html"><a href="r-data-structures.html#heterogeneous-vectors-list"><i class="fa fa-check"></i><b>21.5</b> Heterogeneous vectors: list</a></li>
<li class="chapter" data-level="21.6" data-path="r-data-structures.html"><a href="r-data-structures.html#attributes"><i class="fa fa-check"></i><b>21.6</b> Attributes</a></li>
<li class="chapter" data-level="21.7" data-path="r-data-structures.html"><a href="r-data-structures.html#various-names-attributes"><i class="fa fa-check"></i><b>21.7</b> various names attributes</a></li>
<li class="chapter" data-level="21.8" data-path="r-data-structures.html"><a href="r-data-structures.html#using-structure"><i class="fa fa-check"></i><b>21.8</b> using structure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rs" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Reference Systems</h1>
<p>“<em>Data are not just numbers, they are numbers with a context</em>”; “<em>In data analysis, context provides meaning</em>” <span class="citation">(Cobb and Moore <a href="#ref-cobbmoore">1997</a>)</span></p>
<div id="units" class="section level2">
<h2><span class="header-section-number">7.1</span> Units of measurement</h2>
<div id="quantities" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Quantities</h3>
<p>The VIM (International vocabulary of metrology, <span class="citation">BIPM et al. (<a href="#ref-vim">2012</a>)</span>) defines a <em>quantity</em> as a “property of a phenomenon, body, or substance, where the property has a magnitude that can be expressed as a number and a reference”, where “[a] reference can be a measurement unit, a measurement procedure, a reference material, or a combination of such.”</p>
<p>One could argue whether all data is constitued of quantities, but there is no need to argue that proper data handling requires that numbers are accompanied by information on what the numbers mean, and what they are about.</p>
<p>A measurement system consist of <em>base units</em> for base quantities, and <em>derived units</em> for derived quantities. The SI system of units <span class="citation">(Bureau International des Poids et Mesures <a href="#ref-SI">2006</a>)</span> consist of the seven base units length (metre, m), mass (kilogram, kg), time (second, s), electric current (ampere, A), thermodynamic temperature (kelvin, K), amount of substance (mole, mol), and luminous intensity (candela, cd). Derived units are composed of products of integer powers of base units; exampes are speed (<span class="math inline">\(\mbox{m}~\mbox{s}^{-1}\)</span>) and density (<span class="math inline">\(\mbox{kg}~\mbox{m}^{-3}\)</span>).</p>
<p>Many data variables have units that are not expressed as SI base units or derived units. <span class="citation">Hand (<a href="#ref-hand">2004</a>)</span> discusses many such measurement scales, e.g. those used to measure intelligence in social sciences, in the context of measurement units.</p>
</div>
<div id="unitless-measures" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Unitless measures</h3>
<p>The special case of unitless units can refer to either cases where units cancelled out (e.g. mass fraction: kg/kg, or angle measured in rad: m/m) or to cases where objects or events were counted (e.g. 5 apples). Adding an angle to a count of apples would not make sense; adding 5 apples to 3 oranges may make sense if the result is reinterpreted, e.g. as <em>pieces of fruit</em>. <span class="citation">Flater (<a href="#ref-flater">2018</a>)</span> discusses systems for proper handling of unitless quantities; handling counts could for instance link to domain-specific ontologies pointing out which things were counted, and perhaps identifying super-classes, like <em>fruit</em>.</p>
</div>
<div id="units-in-r" class="section level3">
<h3><span class="header-section-number">7.1.3</span> Units in R</h3>
<p>The <code>units</code> R package <span class="citation">(Pebesma, Mailund, and Hiebert <a href="#ref-unitsrj">2016</a><a href="#ref-unitsrj">b</a>)</span> provides units of measurement support for R, by interfacing the <a href="https://www.unidata.ucar.edu/software/udunits/">udunits2</a> units database and C library. It allows for setting, converting and deriving units:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(units)
(<span class="dt">a =</span> <span class="kw">set_units</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, m))
<span class="co">#&gt; Units: [m]</span>
<span class="co">#&gt; [1] 1 2 3</span>
a_km =<span class="st"> </span><span class="kw">set_units</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, km)
a <span class="op">+</span><span class="st"> </span>a_km
<span class="co">#&gt; Units: [m]</span>
<span class="co">#&gt; [1] 1001 2002 3003</span>
b =<span class="st"> </span><span class="kw">set_units</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>, s)
a <span class="op">/</span><span class="st"> </span>b
<span class="co">#&gt; Units: [m/s]</span>
<span class="co">#&gt; [1] 0.25 0.40 0.50</span></code></pre></div>
<p>and raises errors in case of meaningless operations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a <span class="op">+</span><span class="st"> </span>b
<span class="co">#&gt; Error: cannot convert s into m</span></code></pre></div>
</div>
<div id="datum" class="section level3">
<h3><span class="header-section-number">7.1.4</span> Datum</h3>
<p>For many quantities, the natural origin of values is zero. This works for amounts, and differences between amounts results in meaningful negative values. For locations and times, differences have a natural zero interpretation: length and duration. Absolute location (position) and time need a fixed origin, from which we can meaningfully measure other absolute space-time points: a datum. For space, a datum involves more than one dimension. The combination of a datum and a measurement unit (scale) is a a <em>reference system</em>. The next two sections will deal with temporal and spatial reference systems, and how they are handled in R.</p>
</div>
</div>
<div id="temporal-reference-systems" class="section level2">
<h2><span class="header-section-number">7.2</span> Temporal Reference Systems</h2>
<p>R has two native classes for time-related data: <code>POSIXt</code> and <code>Date</code>, which are used for specifying dates, and times.</p>
<div id="date" class="section level3">
<h3><span class="header-section-number">7.2.1</span> <code>Date</code></h3>
<p><code>Date</code> objects are numeric vectors of class <code>Date</code>, which contain the number of days since (or in case negative: before) Jan 1, 1970:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="dt">d =</span> <span class="kw">as.Date</span>(<span class="st">&quot;1970-02-01&quot;</span>))
<span class="co">#&gt; [1] &quot;1970-02-01&quot;</span>
<span class="kw">as.numeric</span>(d)
<span class="co">#&gt; [1] 31</span></code></pre></div>
<p>We see that the <code>print</code> method as well as the <code>as.Date</code> method use ISO 8601 <span class="citation">(ISO8601 <a href="#ref-iso8601">2000</a>)</span> character strings, which is standard used to read and write dates. We can also modify this to local conventions by specifying a <code>format</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="dt">d =</span> <span class="kw">as.Date</span>(<span class="st">&quot;01.02.1970&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%d.%m.%Y&quot;</span>))
<span class="co">#&gt; [1] &quot;1970-02-01&quot;</span>
<span class="kw">format</span>(d, <span class="dt">format =</span> <span class="st">&quot;%d.%m.%Y&quot;</span>)
<span class="co">#&gt; [1] &quot;01.02.1970&quot;</span></code></pre></div>
<p>The default for <code>format</code> may depend on the locale settings of the computer used. The help page of <code>?as.Date</code> contains further discussion of date systems, and calendars used.</p>
</div>
<div id="posixt" class="section level3">
<h3><span class="header-section-number">7.2.2</span> POSIXt</h3>
<p><code>POSIXt</code> is an R native class for specifying times. It has two subclasses: <code>POSIXct</code> represents time as a numeric, representing decimal seconds since 1970-01-01 00:00 UTC, and <code>POSIXlt</code> contains the same information as a list with all time components (second, minute, hour, day of month, month, year) in list components:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t =<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;1970-01-01 01:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;UTC&quot;</span>)
<span class="kw">as.numeric</span>(t)
<span class="co">#&gt; [1] 3600</span>
<span class="kw">names</span>(<span class="kw">unclass</span>(<span class="kw">as.POSIXlt</span>(t)))
<span class="co">#&gt; [1] &quot;sec&quot;   &quot;min&quot;   &quot;hour&quot;  &quot;mday&quot;  &quot;mon&quot;   &quot;year&quot;  &quot;wday&quot;  &quot;yday&quot;  &quot;isdst&quot;</span>
<span class="kw">unclass</span>(<span class="kw">as.POSIXlt</span>(t))<span class="op">$</span>hour
<span class="co">#&gt; [1] 1</span></code></pre></div>
</div>
<div id="time-zones" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Time zones</h3>
<p>Time zones can be seen as local modifiers of time: where time as numeric value is stored with respect to UTC (universal coordinated time), a local time zone is used to format it, and a time zone can be specified for creation, and formatting:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="dt">t =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;1970-01-01 00:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;PST&quot;</span>))
<span class="co">#&gt; [1] &quot;1970-01-01 PST&quot;</span></code></pre></div>
<p>this adds a time zone modifier to <code>t</code> that redefines the time origin, as</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(t)
<span class="co">#&gt; [1] 0</span></code></pre></div>
<p>To convert <code>POSIXt</code> to <code>Date</code> we can use <code>as.Date</code>; this converts to the <em>local</em> date. Converting back to <code>POSIXct</code> looses the time of day and time zone information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="dt">t =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;1970-01-01 23:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;PST&quot;</span>))
<span class="co">#&gt; [1] &quot;1970-01-01 23:00:00 PST&quot;</span>
<span class="kw">as.Date</span>(t)
<span class="co">#&gt; [1] &quot;1970-01-01&quot;</span>
<span class="kw">format</span>(<span class="kw">as.POSIXct</span>(<span class="kw">as.Date</span>(t)), <span class="dt">tz =</span> <span class="st">&quot;UTC&quot;</span>)
<span class="co">#&gt; [1] &quot;1970-01-01&quot;</span></code></pre></div>
<p>Working with local time zones is sometimes confusing when the data we work with were not referenced to this time zone. It may help to set</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Sys.setenv</span>(<span class="dt">TZ=</span><span class="st">&quot;UTC&quot;</span>)</code></pre></div>
<p>at the start of an R script. The effect is, at lease on some platforms, that R thinks it is working in a UTC time zone. This way, the scripts will produce identical outputs, no matter in which time zone it is run.</p>
</div>
</div>
<div id="crs" class="section level2">
<h2><span class="header-section-number">7.3</span> Coordinate Reference Systems</h2>
<p>We follow <span class="citation">Lott (<a href="#ref-lott2015geographic">2015</a>)</span> when defining the following concepts (italics indicate literal quoting):</p>
<ul>
<li>a <strong>coordinate system</strong> is a <em>set of mathematical rules for specifying how coordinates are to be assigned to points</em></li>
<li>a <strong>datum</strong> is a <em>parameter or set of parameters that define the position of the origin, the scale, and the orientation of a coordinate system</em>,</li>
<li>a <strong>geodetic datum</strong> is a <em>datum describing the relationship of a two- or three-dimensional coordinate system to the Earth</em>, and</li>
<li>a <strong>coordinate reference system</strong> is a <em>coordinate system that is related to an object by a datum; for geodetic and vertical datums, the object will be the Earth.</em></li>
</ul>
<p>A readable text that further explains these concepts is <span class="citation">Iliffe and Lott (<a href="#ref-iliffelott">2008</a>)</span>.</p>
<p>Essentially it boils down to the Earth not following a regular shape. The topography of the Earth is of course known to vary strongly, but also the surface formed by constant gravity at mean sea level, the geoid, is irregular. A commonly used model that is fit to the geoid is an ellipsoid of revolution, which is an ellipse with two identical minor axes. This model can be fit locally to be highly precise, can be fixed for particular tectonic plates (like ETRS89), or can be globally fit (like WGS84).</p>
<p>The definitions above state that coordinates in degrees longitude and latitude can only have a meaning, i.e. can only be understood as Earth coordinates when the datum they relate to is given.</p>
<p>Recomputing coordinates in a new datum is called <em>coordinate transformation</em>.</p>
<div id="projections" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Projections</h3>
<p>When we look at geographical data on a paper map or a screen, or on any <em>flat</em> device, we see the values <em>projected</em> – they are no longer arranged on an a sphere or ellipsoid. Even if we plot degrees longitude/latitude data on a flat x/y plane with unit aspect ratio, we use a projection, called <em>plate carrée</em>.</p>
<p>Note that even for projected data, the data that <em>were</em> projected are associated with a reference ellipsoid (datum). Going from one projection to the other without changing datum is called <em>coordinate conversion</em>, and usually passes through the geodetic coordinates of the datum involved; up to numerical errors this process is lossless and invertible.</p>
</div>
<div id="describing-coordinate-reference-systems" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Describing Coordinate Reference Systems</h3>
<p><span class="citation">Lott (<a href="#ref-lott2015geographic">2015</a>)</span> describes a standard for encoding coordinate reference system using <em>well known text</em>; the standard is referred to as WKT2. GDAL and PROJ support this encoding (FIXME: verify this is true by the time this book goes into print).</p>
<p>Traditionally, PROJ used a string representation to encode coordinate reference systems (datums) and projections, called the proj4string. Some of these come from a catalogue (originally) compiled by the European Petroleum Survey Group (now: International Association of Oil &amp; Gas Producers), and have a so-called epsg code.</p>
<p>Package <code>sf</code> provides a <code>crs</code> class which is initialised either by an epsg code, like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_crs</span>(<span class="dv">4326</span>)
<span class="co">#&gt; Coordinate Reference System:</span>
<span class="co">#&gt;   EPSG: 4326 </span>
<span class="co">#&gt;   proj4string: &quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span></code></pre></div>
<p>or by a PROJ string, like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_crs</span>(<span class="st">&quot;+proj=longlat&quot;</span>)
<span class="co">#&gt; Coordinate Reference System:</span>
<span class="co">#&gt;   EPSG: 4326 </span>
<span class="co">#&gt;   proj4string: &quot;+proj=longlat +ellps=WGS84 +no_defs&quot;</span></code></pre></div>
<p>and can be missing valued</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_crs</span>()
<span class="co">#&gt; Coordinate Reference System: NA</span></code></pre></div>
<p>A number of methods are available for <code>crs</code> objects:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">methods</span>(<span class="dt">class =</span> <span class="st">&quot;crs&quot;</span>)
<span class="co">#&gt; [1] $          is.na      Ops        print      st_as_text st_crs    </span>
<span class="co">#&gt; see &#39;?methods&#39; for accessing help and source code</span></code></pre></div>
<p>The <code>Ops</code> methods are convenience functions, e.g.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_crs</span>(<span class="dv">4326</span>) <span class="op">==</span><span class="st"> </span><span class="kw">st_crs</span>(<span class="st">&quot;+proj=longlat&quot;</span>)
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
<p>but there not all cases semantically identical <code>crs</code> objects will yield equality in this test.</p>
<p><code>st_as_text</code> converts a <code>crs</code> object into WKT, we print it using <code>cat</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="kw">st_as_text</span>(<span class="kw">st_crs</span>(<span class="dv">4326</span>), <span class="dt">pretty =</span> <span class="ot">TRUE</span>))
<span class="co">#&gt; GEOGCS[&quot;WGS 84&quot;,</span>
<span class="co">#&gt;     DATUM[&quot;WGS_1984&quot;,</span>
<span class="co">#&gt;         SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,</span>
<span class="co">#&gt;             AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],</span>
<span class="co">#&gt;         AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],</span>
<span class="co">#&gt;     PRIMEM[&quot;Greenwich&quot;,0,</span>
<span class="co">#&gt;         AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],</span>
<span class="co">#&gt;     UNIT[&quot;degree&quot;,0.0174532925199433,</span>
<span class="co">#&gt;         AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],</span>
<span class="co">#&gt;     AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</span></code></pre></div>
<p>It should be noted that at the time of writing this, a new draft standard for WKT (informally called WKT2, <span class="citation">Lott (<a href="#ref-lott2015geographic">2015</a>)</span>) is rapidly being implemented in GDAL and PROJ, and can be expected in R once these changes appear in released versions.</p>
<p><code>st_crs</code> is also a generic, with methods for</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">methods</span>(st_crs)
<span class="co">#&gt;  [1] st_crs.bbox*      st_crs.character* st_crs.crs*      </span>
<span class="co">#&gt;  [4] st_crs.default*   st_crs.numeric*   st_crs.Raster*   </span>
<span class="co">#&gt;  [7] st_crs.sf*        st_crs.sfc*       st_crs.Spatial*  </span>
<span class="co">#&gt; [10] st_crs.stars*    </span>
<span class="co">#&gt; see &#39;?methods&#39; for accessing help and source code</span></code></pre></div>
<p>The method for <code>sfc</code> objects can drill further into the underlying data, by adding an argument; a few of these are printed by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_crs</span>(<span class="kw">st_sfc</span>(<span class="dt">crs =</span> <span class="dv">4326</span>), <span class="dt">parameters =</span> <span class="ot">TRUE</span>)[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">8</span>)]
<span class="co">#&gt; $SemiMajor</span>
<span class="co">#&gt; 6378137 [m]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $SemiMinor</span>
<span class="co">#&gt; 6356752 [m]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $InvFlattening</span>
<span class="co">#&gt; [1] 298</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $units_gdal</span>
<span class="co">#&gt; [1] &quot;degree&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ud_unit</span>
<span class="co">#&gt; 1 [°]</span></code></pre></div>
<p>where we see that udunits and GDAL units are integrated. The major axis lengths (<code>SemiMajor</code>) and inverse flattening are used e.g. to compute great circle distances on the ellipsoid, using the algorithm from <span class="citation">Karney (<a href="#ref-karney2013algorithms">2013</a>)</span>. This algorithm is implemented in PROJ, and interfaced by <code>lwgeom::st_geod_distance</code>, which is called from <code>sf::st_distance</code> when objects have geodetic coordinates.</p>

</div>
</div>
</div>



<h3>References</h3>
<div id="refs" class="references">
<div id="ref-cobbmoore">
<p>Cobb, George W., and David S. Moore. 1997. “Mathematics, Statistics and Teaching.” <em>The American Mathematical Monthly</em> 104 (9): 801–23. <a href=" http://www.jstor.org/stable/2975286 ">http://www.jstor.org/stable/2975286</a>.</p>
</div>
<div id="ref-vim">
<p>BIPM, IEC, ILAC IFCC, IUPAP IUPAC, and OIML ISO. 2012. “The International Vocabulary of Metrology–Basic and General Concepts and Associated Terms (Vim), 3rd Edn. Jcgm 200: 2012.” <em>JCGM (Joint Committee for Guides in Metrology)</em>. <a href="https://www.bipm.org/en/publications/guides/" class="uri">https://www.bipm.org/en/publications/guides/</a>.</p>
</div>
<div id="ref-SI">
<p>Bureau International des Poids et Mesures. 2006. <em>The International System of Units (SI), 8th Edition</em>. Organisation Intergouvernementale de la Convention du Mètre. <a href="https://www.bipm.org/en/publications/si-brochure/download.html" class="uri">https://www.bipm.org/en/publications/si-brochure/download.html</a>.</p>
</div>
<div id="ref-hand">
<p>Hand, David J. 2004. <em>Measurement: Theory and Practice</em>. A Hodder Arnold Publication.</p>
</div>
<div id="ref-flater">
<p>Flater, David. 2018. “Architecture for Software-Assisted Quantity Calculus.” <em>Computer Standards &amp; Interfaces</em> 56: 144–47. doi:<a href="https://doi.org/10.1016/j.csi.2017.10.002">10.1016/j.csi.2017.10.002</a>.</p>
</div>
<div id="ref-unitsrj">
<p>Pebesma, Edzer, Thomas Mailund, and James Hiebert. 2016b. “Measurement Units in R.” <em>The R Journal</em> 8 (2): 486–94. doi:<a href="https://doi.org/10.32614/RJ-2016-061">10.32614/RJ-2016-061</a>.</p>
</div>
<div id="ref-iso8601">
<p>ISO8601, ISO. 2000. “Data Elements and Interchange Formats–Information Interchange–Representation of Dates and Times.” <em>ISO/Tc154</em>.</p>
</div>
<div id="ref-lott2015geographic">
<p>Lott, Roger. 2015. “Geographic Information-Well-Known Text Representation of Coordinate Reference Systems.” Open Geospatial Consortium. <a href=" http://docs.opengeospatial.org/is/12-063r5/12-063r5.html ">http://docs.opengeospatial.org/is/12-063r5/12-063r5.html</a>.</p>
</div>
<div id="ref-iliffelott">
<p>Iliffe, Jonathan, and Roger Lott. 2008. <em>Datums and Map Projections for Remote Sensing, Gis, and Surveying. Whittles Pub</em>. CRC Press, Scotland, UK.</p>
</div>
<div id="ref-karney2013algorithms">
<p>Karney, Charles FF. 2013. “Algorithms for Geodesics.” <em>Journal of Geodesy</em> 87 (1). Springer: 43–55. <a href="https://link.springer.com/content/pdf/10.1007/s00190-012-0578-z.pdf" class="uri">https://link.springer.com/content/pdf/10.1007/s00190-012-0578-z.pdf</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="featureattributes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/edzer/sdsr/edit/master/07-ReferenceSystems.Rmd",
"text": "Edit"
},
"download": ["sds.pdf", "sds.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
